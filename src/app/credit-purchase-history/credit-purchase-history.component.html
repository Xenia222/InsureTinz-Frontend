<app-navbar></app-navbar>
<div class="" style="padding: 0 0px !important;
overflow-x: hidden;">
    <div class="row">
        <app-sidebar style="padding-right: 0 !important;"></app-sidebar>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 content">
            <div class="content">

                <!-- Sale & Revenue Start -->
                <div class="container-fluid pt-4 px-4 subc">

                    <div class="bann">
                        <section class=" bg-white rounded">
                            <div class="row" class="d-flex" >
                                <div class="col-sm-3">
                                    <div class="p-3 bigtext">
                                        <h4>Credit <br> Used</h4>
                                        <p><strong class="color2 fs-2">{{formatNumber(user_credit_balance)}}</strong> 
                                        </p>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="p-3 bigtext">
                                        <h4>Credit <br> Balance</h4>
                                        <p><strong class="color3 fs-2">{{formatNumber(user_credit)}}</strong> </p>
                                    </div>
                                </div>
                                <div *ngxPermissionsOnly="['client_buy_credit']"  class="col-sm-3 d-flex justify-content-center align-items-center">
                                    <div class="p-3  ">
                                        <button (click)="navigateToCreditsPage()" type="button" class="btn btn-warning col align-item-center" routerLink="/credits"><strong>Purchase
                                                Credit</strong></button>
                                    </div>
                                </div>
                            </div>
                        </section>
                
                        <div *ngxPermissionsOnly="['client_view_payment_history']" class=" mt-3 " style="padding: 0px;">
                            <div class="btn-group grouppp" role="group" aria-label="Basic example">
                
                                <div class="sous-group">
                                    <img src="../../assets/filter.png" alt="">
                                </div>
                                <div class="sous-group">
                                    <span>filter by</span>
                                </div>
                                <div class="col-auto sous-group">
                                    <select [(ngModel)]="selectedPayement" class="form-select bg-light">
                                        <option *ngFor="let category of payement" [value]="category">{{ category }}</option>
                                    </select>
                                    
                                </div>
                                <div class="col-auto sous-group">
                                    <label for="startDate">Start-date:</label>
                                    <input type="date" class="form-control" style="background-color: #F5F6FA; color: #202224; margin-bottom: 5px;" id="startDate" [(ngModel)]="startDate">
                                </div>
                                <div class="col-auto sous-group">
                                    <label for="endDate">End-date:</label>
                                    <input type="date" class="form-control" style="background-color: #F5F6FA; color: #202224; margin-bottom: 5px;" id="endDate" [(ngModel)]="endDate">
                                </div>
                                <div class="" (click)="refreshPage()" style="cursor: pointer;">
                                    <span><img src="../../assets/ic-replay-24px.png" alt=""> Reset filter</span>
                                </div>
                
                            </div>
                
                        </div>
                        <div *ngxPermissionsOnly="['client_view_payment_history']">
                
                            <section class="">
                                <div class="container-fluid mt-3 rounded ">
                                    <div class="row">
                                        <div class="card col-12 table-responsive" style="padding-left: 0px; padding-right: 0px;">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Time</th>
                                                        <th>Credits Amount</th>
                                                        <th>Payement method</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let transact of filteredItems">
                                                        <td>{{transact.updated_at | date : "dd/MM/yyyy"}}</td>
                                                        <td>{{transact.updated_at | date: "hh:mm:ss"}}</td>
                                                        <td>{{transact.amount}} FCFA</td>
                                                        <td>{{transact.payment_method}}</td>
                                                        <td>{{transact.status}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
    const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]')
    const popoverList = [...popoverTriggerList].map(popoverTriggerEl => new bootstrap.Popover(popoverTriggerEl))
</script>